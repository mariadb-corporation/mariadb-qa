INSTALL PLUGIN Spider SONAME 'ha_spider.so';
CREATE SERVER srv FOREIGN DATA WRAPPER mysql OPTIONS (SOCKET '../socket.sock',DATABASE 'test',user 'Spider',PASSWORD '');
CREATE TABLE t1 (a INT,b VARCHAR(255),PRIMARY KEY(a)) ENGINE=Spider COMMENT="srv 'srv', table 't1', read_only_mode '1'";
INSERT INTO t1 VALUES (1,'aaa'),(2,'bbb'),(3,'ccc'),(4,'ddd');
SHOW CREATE TABLE t1;
DROP TABLE t1;
CREATE TABLE t1 (a INT) ENGINE=Spider COMMENT='port "123 456"';
INSERT IGNORE INTO t1 VALUES (42),(42);

INSTALL PLUGIN Spider SONAME 'ha_spider.so';
CREATE SERVER srv FOREIGN DATA WRAPPER MYSQL OPTIONS (SOCKET '../socket.sock',DATABASE 'test',user 'Spider',PASSWORD '');
SET GLOBAL spider_same_server_link=ON;
CREATE TABLE t1 (c INT KEY,c1 BLOB,c2 TEXT) ENGINE=Spider COMMENT='WRAPPER "mysql",SRV "srv",TABLE "t"';
INSERT INTO t1 VALUES (1,"aaa"),(2,"bbb"),(3,"ccc"),(4,"ddd");
SHOW CREATE TABLE t1;
CREATE TABLE t1 (a INT,b VARCHAR,PRIMARY KEY(a)) ENGINE=InnoDB REMOTE_SERVER="srv" REMOTE_TABLE="t1" read_only=maybe;
DROP TABLE t1;
CREATE TABLE t1 (a INT) ENGINE=Spider REMOTE_PORT="123 456";
SELECT SQL_NO_CACHE * FROM t1;

FLUSH PRIVILEGES;
GRANT ALL ON test.* TO Spider@localhost;
INSTALL PLUGIN Spider SONAME 'ha_spider.so';
SET SESSION SPIDER_IGNORE_COMMENTS=1;
DROP TABLE t1;
CREATE TABLE t1 (c INT, PRIMARY KEY(c)) ENGINE=Spider COMMENT='WRAPPER "mysql", SRV "srv",TABLE "t2", PK_NAME "c"';
FLUSH PRIVILEGES;
SELECT * FROM t1;
INSERT INTO t1 VALUES (42);
SHOW CREATE TABLE t1;
DROP TABLE t1;
CREATE TABLE t1 (a INT) ENGINE=Spider REMOTE_PORT="123 456";
SELECT * FROM t1;
