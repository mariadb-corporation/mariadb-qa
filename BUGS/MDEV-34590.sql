INSTALL PLUGIN Spider SONAME 'ha_spider.so';
CREATE SERVER srv FOREIGN DATA WRAPPER MYSQL OPTIONS (SOCKET '../socket.sock',DATABASE'',USER'',PASSWORD'');
CREATE TABLE t1 (c1 INT) ENGINE=InnoDB;
CREATE TABLE t2 (c1 INT) ENGINE=Spider COMMENT='WRAPPER "mysql",SRV "srv",TABLE "t1"';
CREATE TABLE t3 (c1 INT,c2 INT) ENGINE=Spider;
SELECT * FROM t2;
SELECT * FROM t3;
LOCK TABLES t2 WRITE;
ALTER TABLE t2 CHANGE c1 c1 DOUBLE;
INSERT INTO t3 VALUES (1);

SET sql_mode='';
INSTALL PLUGIN Spider SONAME 'ha_spider.so';
CREATE SERVER srv FOREIGN DATA WRAPPER MYSQL OPTIONS(SOCKET '../socket.sock',DATABASE'',USER'',PASSWORD'');
CREATE TABLE t(c INT KEY,c1 BLOB,c2 TEXT)ENGINE=InnoDB;
CREATE TABLE tm(c INT KEY,c1 BLOB,c2 TEXT)ENGINE=InnoDB;
CREATE TABLE t2(c INT KEY,c1 BLOB,c2 TEXT)ENGINE=Spider COMMENT='WRAPPER "mysql",SRV "srv",TABLE "tm"';
CREATE TABLE t1(a INT,b INT);
CREATE TABLE t4(a INT,b INT,c BINARY,d CHAR,e VARCHAR,f BINARY,g BLOB,h BLOB,id INT,KEY(b)) ENGINE=Spider;
ALTER TABLE t ENGINE=Spider;
INSERT INTO t2 VALUES;
INSERT INTO t VALUES(+1,+1,'5N1aeHtODhdCmVYN7Ast2KxJSwjeYHa1EUtVtDcadpiBMBZBwzXiQS2T1','W8yyD2sFd11Ibx7otOfVq','BdjduxFqUVPmwMMs2HAQDr','Iih1fyrhuV1AaIiQylloGOVvLnHZZL2c56exxPcIhjfajFG7M',6);
ALTER TABLE t4 ENGINE=Spider;
LOCK TABLES t1 AS a2 READ,t2 AS a9 WRITE,t1 AS a6 WRITE;
DROP TABLE IF EXISTS t1,t2;
INSERT INTO t VALUES(0xAAE6);

# mysqld options required for replay:  --maximum-query_alloc_block_size=1M
INSTALL PLUGIN Spider SONAME 'ha_spider.so';
CREATE SERVER srv FOREIGN DATA WRAPPER MYSQL OPTIONS (SOCKET '../socket.sock',DATABASE'',USER'',PASSWORD'');
CREATE TABLE t (c INT,c1 BLOB,c2 TEXT) ENGINE=InnoDB;
CREATE TABLE t1 (c INT,c1 BLOB,c2 TEXT) ENGINE=Spider COMMENT='WRAPPER "mysql",SRV "srv",TABLE "t"';
CREATE TABLE t3 (a INT,b INT,KEY(a,b)) ENGINE=Spider;
SET GLOBAL t_open_cache=1;
INSERT INTO t1 SELECT * FROM t1;
XA COMMIt;
DELETE FROM t3 WHERE a=6 AND a=8;
LOCK TABLES t1 WRITE;
DROP TABLE t1;
ALTER TABLE t1 DROP PARTITION p0;
SELECT * FROM t1,t3 WHERE tb=2 AND ta=1;
